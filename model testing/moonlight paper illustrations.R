library(tidyverse)

# Plotting moon phase vs disk brightness

#Data points
#phase angle in degrees
phaseAngle <- c(0.367186581,0.561328356,0.755753776,1.017911051,1.343778816,1.638020082,1.9321973,2.201542706,2.446200869,2.690859033,2.960111111,3.304228275,3.798169858,4.566540124,5.659518624,6.926950784,8.294080819,9.760921815,11.2775818,12.86918679,14.51056309,16.15193939,17.79332234,19.43470363,21.07608991,22.71746788,24.55846678,26.59940044,28.6403448,30.68133202,32.72256159,34.76382063,36.805081,38.84640163,40.88817885,42.93016095,44.97243897,47.01472501,49.05701374,51.09936005,53.14188578,55.18442088,57.22695599,59.2695018,61.3123181,63.35526696,65.39821581,67.44116333,69.48411219,71.52711193,73.57035938,75.61364299,77.65692793,79.7002102,81.74354871,83.78698764,85.8304172,87.87385613,89.91732854,91.961129,94.00502721,96.04892543,98.09282096,100.1367821,102.1807767,104.2247874,106.2687927,108.3127874,110.3568141,112.4010042,114.4452425,116.4894862,118.5337607,120.5781851,122.6226792,124.6673768,126.7121119,128.7568778,130.8016611,132.8463627,134.8910482,136.9357699,138.9805559,141.0253124,143.0700395,145.1147611,147.1594494,149.2040787,151.2487227,153.2933882,155.3381112,157.382853,159.4275827,161.4723968,163.517239,165.5620973,167.6069529,169.6517964,171.6966668,173.7414943,175.786378,177.8311961,179.5020253
)

#converting phase angle to % illuminated
discIlluminated <- (1+ cos(phaseAngle*pi/180))/2

#disc-integrated brighness
phaseBrightness <- c(0.981495601,0.957317682,0.93441936,0.911719223,0.887147319,0.864543232,0.841650203,0.819234668,0.797948808,0.776662948,0.753826384,0.731224944,0.709518906,0.688329272,0.669028531,0.649231859,0.629197232,0.608983672,0.588516023,0.568644051,0.54830288,0.52796171,0.50765056,0.487331904,0.467035764,0.446702099,0.426908396,0.409070349,0.391280626,0.373684202,0.357181123,0.340810937,0.324446792,0.308354473,0.294321992,0.281213721,0.269440419,0.25770336,0.245978382,0.234513149,0.223857355,0.213243844,0.202630334,0.192065148,0.18272016,0.17397319,0.165226219,0.156473208,0.147726238,0.139208809,0.131808889,0.124572064,0.11734128,0.110098415,0.103109254,0.096573137,0.089994736,0.083458618,0.077073516,0.072168356,0.067704159,0.063239962,0.058763683,0.054583393,0.050554118,0.04659733,0.042616379,0.038587104,0.034702802,0.031555452,0.028625563,0.025719836,0.022953043,0.020862794,0.019086656,0.018228687,0.017539854,0.016989954,0.016518582,0.015678735,0.0147664,0.014017161,0.013557871,0.012965687,0.01224061,0.011491371,0.010591118,0.009425079,0.008325486,0.007322543,0.006579345,0.005920715,0.005207719,0.004875281,0.004669694,0.004536595,0.004391414,0.004191868,0.004113134,0.003841101,0.003822773,0.003508456,0.003536722
)

ggplot()+
  geom_line(aes(x=discIlluminated,y=phaseBrightness))+
  xlab("Lunar phase (% of lunar face illuminated)")+
  ylab("Disk-integrated brightness")+
  theme_bw()

# formula for extinction coefficient
altitude <- 5000

extCoef <- 0.00000001*(altitude^2)-8*10^-5*altitude+0.2795

extCoef
  